<!----------------------------------------------------------------------------------------------------------------------
  -- Note Page
  --------------------------------------------------------------------------------------------------------------------->

<template>
    <MarkdownContent id="note-page" :text="renderedContent" :class="`${ system }-system`"></MarkdownContent>
</template>

<!--------------------------------------------------------------------------------------------------------------------->

<style lang="scss">
    #note-page {
        & > p:first-child {
            margin-top: 0;
        }

        & > p:last-child {
            margin-bottom: 0;
        }
    }
</style>

<!--------------------------------------------------------------------------------------------------------------------->

<script lang="ts" setup>
    import { computed, ref, onMounted } from 'vue';
    import { marked } from 'marked';

    // Managers
    import charMan from '../../lib/managers/character';

    // Components
    import MarkdownContent from '../ui/markdown.vue';

    //------------------------------------------------------------------------------------------------------------------
    // Component Definition
    //------------------------------------------------------------------------------------------------------------------

    interface Props
    {
        content : string;
    }

    const props = defineProps<Props>();

    //------------------------------------------------------------------------------------------------------------------
    // Refs
    //------------------------------------------------------------------------------------------------------------------

    const system = ref<string | null>(null);

    //------------------------------------------------------------------------------------------------------------------
    // Computed
    //------------------------------------------------------------------------------------------------------------------

    const renderedContent = computed(() =>
    {
        return marked(props.content);
    });
    //------------------------------------------------------------------------------------------------------------------
    // Lifecycle
    //------------------------------------------------------------------------------------------------------------------

    onMounted(() =>
    {
        // TODO: Remove this in favor of getting the current character's system from a store
        system.value = charMan.selected.system;
    });
</script>

<!--------------------------------------------------------------------------------------------------------------------->
